<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClassDojo 學生排名顯示器</title>
    <!-- 載入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 載入 Noto Sans TC 作為主要中文字體 -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* 設定 9:16 容器，確保在不同尺寸下保持比例 */
        .portrait-container {
            width: 100%;
            max-width: 500px; /* 限制最大寬度以模擬廣告機屏幕 */
            aspect-ratio: 9 / 16;
            margin: 0 auto;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border-radius: 1.5rem; /* 圓角邊框 */
            border: 8px solid #3b82f6; /* 藍色邊框，像圖畫紙 */
        }
        /* 使用 Fredoka 或 Noto Sans TC 讓字體更活潑 */
        body {
            font-family: 'Fredoka', 'Noto Sans TC', sans-serif;
            background-color: #f0f9ff; /* 淺藍色背景 */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .text-shadow-playful {
            text-shadow: 2px 2px 0 #fff, 4px 4px 0 #ef4444; /* 紅白疊影，增加立體感 */
        }
        .rank-card {
            transition: all 0.3s ease;
            transform-origin: center;
        }
        .rank-card:hover {
            transform: scale(1.03);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="p-4">

    <!-- 9:16 廣告機屏幕容器 -->
    <div id="app" class="portrait-container bg-yellow-100 flex flex-col p-4 sm:p-6 md:p-8">
        
        <!-- 標題區 -->
        <header class="text-center mb-6">
            <h1 class="text-3xl sm:text-4xl font-black text-red-500 text-shadow-playful leading-tight">
                🏆 ClassDojo 學生排行榜
            </h1>
            <p id="class-title" class="text-xl sm:text-2xl font-bold mt-2 p-1 bg-white rounded-full inline-block shadow-md border-4 border-yellow-500 text-blue-600">
                正在載入...
            </p>
            <!-- 頁碼指示器 -->
            <p id="page-indicator" class="text-md text-gray-700 mt-1 font-semibold"></p>
        </header>

        <!-- 排名列表區 -->
        <div id="ranking-list" class="flex-grow overflow-y-auto space-y-3 p-2">
            <!-- 排名卡片將由 JavaScript 填充 -->
        </div>

        <!-- 註腳 -->
        <footer class="text-center mt-6 text-gray-500 text-sm">
            <p class="text-xs mt-1">數據更新於：2025年10月25日</p>
        </footer>

        <!-- 錯誤訊息或提示 -->
        <div id="error-message" class="hidden text-center text-red-600 font-bold p-4 bg-red-100 rounded-lg mt-4 border-2 border-red-500">
            找不到班級數據。
        </div>
        
        <!-- 分頁和班級導航 -->
        <div id="nav-controls" class="mt-4">
            <!-- 班級導航 -->
            <div id="class-nav-links" class="flex flex-wrap justify-center gap-2 mb-4"></div>
            <!-- 分頁按鈕 -->
            <div id="pagination-controls" class="flex justify-between items-center px-4"></div>
        </div>

    </div>

    <script>
        // ----------------------------------------------------
        // 1. 內嵌 CSV 數據 (請將您的報告內容貼在此處)
        // ----------------------------------------------------
        const csvData = `
        Name,Year,Classes,Positive,Needs Work,九月份班級經營得獎 - schoolwide (5),Answer questions (1),Appreciate you (1),Assembly (1),Attentive (1),Bible textbook (5),CHINESE HOMEWROK (1),Disobey (-5),Eng HW (1),English (Mr Ma) (1),English Dictation (1),English HW (1),FINISH LUNCH (1),Good student (5),Good students (5),Helping others (1),No textbook - (-1),On task (1),Participating (1),Persistence (1),Teamwork (1),Working hard (1),answer questions (1),bad behavior (-1),competition (5),disobey (-5),improvement (5),no textbook (mixed weight),not attentive (-1),sleeping (-1),一星期交齊功課 (5),上課表現良好 (1),不守規 (-1),不專心 (-1),不認真吃飯 (-1),不遵守紀律 (-1),中-上課有進步 (1),中-交齊功課 (1),中-專心上課 (1),中-積極嘗試 (1),交齊功課 (1),交齊數學功課 (1),全班交齊常識功課 (1),全班專心 (1),六望班級經營 (5),出位 (-1),功課GOOD (3),升旗隊 (1),午膳 (1),午膳表現良好 (1),協助老師 (1),周老師讚賞你 (1),回答問題 (1),圖書閱讀 (1),圖書館欠缺當值 (-2),圖書館沒有當值 (-2),圖書館當值 (1),大叫 (-1),安靜上禮堂 (3),完成每月篇篇流螢 (5),專心上課(數) (1),帶餐墊 (1),帶齊物品 (1),帶齊餐具 (1),常識功課 甲等表現 (1),常識表現好 (1),成績優異 (1),擅自出位 (-1),數學功課 (1),數學功課欠改正 (-1),早會表現良好 (1),早讀 (1),服務 (1),未完成全部功課 (-1),欠交功課 (-1),欠做功課 (-1),欠做改正 (-1),欠功課 (mixed weight),欠寫日期 (-1),欠帶課本 (-1),欠改正 (-1),欠數學功課 (-1),欠書 (-1),欠簽手冊 (-1),欠責任感 (-1),每日十題 (1),每月一聽 (5),沒有借/帶圖書 (-1),沒有舉手 (-1),甘老師欣賞你 (1),發電 (-1),積極答題 (1),自律守規 (1),蔡老師不欣賞你 (-1),蔡老師欣賞你 (1),蔡老師欣賞你☺️ (1),表現值得欣賞 (1),製造噪音 (-3),視藝課表現出色 (1),認真作答 (1),認真完成每日十題 (1),請專心 (-1)
01_AFRIDI MUHAMMAD ZAMAN,1st Grade,2025-2026年度 1信,63,2,10,,,,,,,,,,,,1,,,1,,23,16,2,,2,,,,,,,,,,,-1,-1,,,,,,,,,,,,,,,,,,6,,,,,,,,,,,,,,,,,,,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
01_AYAAN SHER,2nd Grade,2025-2026年度 2信,141,3,,,,,,,,,,52,,3,,,,1,,19,12,5,7,6,,,,,,,,,,10,-1,,,,,,,,,,,,,,,,,,,,7,2,,,,,,,1,,,,,12,,,1,,1,,,,,,,,,,,,,,,,,-2,,,,,,,,,,,2,,,
01_伊百德,3rd Grade,2025-2026年度 3信,64,18,,,,,,,,,,,,,,10,,,,21,21,,,1,,,,,,-2,,,,,,,-1,-5,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,2,,,,,-4,-1,,,,,-5,,,,,,,,,,,,,,,,,,,,
01_安伊婭,6th Grade,2025-2026年度 6望,245,1,30,17,,,,,,,,,,,,,,12,,38,19,11,13,16,,,,,,,,,,,-1,,,,,,,,,3,,,20,,,,6,,3,,8,,,,,,,,,,,,,19,,,,,4,,,,,,,,,,,,,,,7,,,,2,,9,,,,,,,,,,
01_歐陽霦,5th Grade,2025-2026年度 5信,249,45,35,,2,,47,,7,,,,,,,,95,,,11,19,,,,,,,-35,,,-9,,,,,,,,,,,,,,,2,,,,,,,,,,,,,,,,,,8,,10,,5,,,2,,3,,,,,,,,,,,,,,,,,,,,-1,,,,,,,,,3,,
01_穆娜婭,6th Grade,2025-2026年度 6信,169,2,35,,2,12,,5,,,2,,,,,,,,,34,14,3,18,11,8,-1,,,,,,,,,,,,,,,,,,1,1,,,,,,,,,,,,,,,,,,,,,,6,,,,,,3,,,,,,,-1,,,,,,,,,,,,,,,,,4,,,,,,,
01_薩麗嫣,4th Grade,2025-2026年度 4信,131,2,25,4,,,,,,,,,,,,,,1,,13,20,,,3,,,,,5,,,,5,,,,,,,,,,7,,,,,,,,,11,,,,,-2,,5,,,5,,,,,,,,,,,10,,6,,,,,,,,,,,,,,,,,,,,10,,,,1,,,,,
02_ABDULLAH ALINA,6th Grade,2025-2026年度 6望,258,29,30,18,,,,5,,,,,,,,,,12,,40,23,11,13,16,,,,,,-10,,,,,-10,,,,,,,,,3,,,20,,,,6,,3,,9,,,,,,,,,,,,,19,,,,,5,,,,,,,,,,,,,,,5,,,-8,2,-1,18,,,,,,,,,,
02_李瓦利,1st Grade,2025-2026年度 1信,77,2,10,,,,,,,,,,,,2,,,1,,27,18,2,,5,,,,,,,,,,,-1,-1,,,,,,,,,,,,,,,,,,10,,,,,,,,,,,,,,,,,,,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
02_歐陽燊,6th Grade,2025-2026年度 6信,189,13,35,,3,12,,5,,,2,,,,,,,,,51,15,3,15,12,10,-10,,,,,,,,,,,,,,,,,,1,1,,,,,,,,3,,,,,,,,,,,,,,4,,,,,,3,,,-1,,,,,-1,,,,,-1,,,,,,,,,,,4,,,,,,,
02_簡翠瑩,2nd Grade,2025-2026年度 2信,114,2,,,,,,,,,,1,,3,,,,,,16,11,4,6,6,,,,,,,,,,30,,,,,6,2,4,,,,,,,,,,,,,,4,2,,,,,,,1,,,,,11,,,1,,1,,,,,,,,,,,,,,,,,-2,,,,,,,,,,,2,,,
02_薩美嫣,4th Grade,2025-2026年度 4信,181,,25,13,,,,,,,,,,,,,,1,,18,41,,1,4,,,10,,5,,,,5,,,,,,,,,,6,,,,,,,1,,11,,,,,,,,,,5,,,1,,,,,,,,10,,8,,,,,,,,,,,,,,,,,,,,11,,,,5,,,,,
02_陳政謙,3rd Grade,2025-2026年度 3信,101,7,,,,,,,,,,,,,,10,,2,,32,39,,,1,,,,,,-1,,,,,,,,-5,,,,,,,,,,,,,,,,,,,,,,-1,9,,,,,,,,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,6,
02_陳柏樂,5th Grade,2025-2026年度 5信,264,36,35,,2,,58,,7,,,,,,,,95,,,12,19,,,,,,,-30,,,-5,,,,,,,,,,,,,,,2,,,,,,,,,,,,,,,,,,8,,11,,5,,,4,,3,,,,,,,,,,,,,,,,,,,,-1,,,,,,,,,3,,
03_KHAN ABEEHA,2nd Grade,2025-2026年度 2信,105,6,,,,,,,,,,3,,2,,,,,,16,9,4,6,4,,,,,,,,,,27,-2,,,,8,1,2,,,,,,,,,,,,,,4,,,,,,,,,,,,,13,,,1,,1,,,,-3,,,,,,,,,,,,,-1,,,,,,,,,,,2,,,
03_周俊彥,3rd Grade,2025-2026年度 3信,94,12,,,,,,,,,,,,,,25,,,,30,21,,2,5,,,,,,-1,,,,,,,,-3,,,,,,,,,,,,,,,,,,,,,,-1,9,,,,,,,,,,,,2,,,,,-3,-4,,,,,,,,,,,,,,,,,,,,,,,,,
03_周皓希,5th Grade,2025-2026年度 5信,186,61,35,,2,,12,,,,,,,,,,70,,,15,18,1,1,2,,,,-30,,-14,-4,,,,,,,,,,,,,,,1,,,,,,,,,,,,,,,,,,8,,10,,5,,,1,,3,,,,,,,-9,,,,,-1,,,,,,,,-3,,,,,,,,,2,,
03_穆娜花,1st Grade,2025-2026年度 1信,101,3,10,,,,,,,,,,,,5,,,1,,39,19,2,,3,,,,,,,,,,,-1,-1,,,,,,,,,,,,,,,,,,18,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,-1,,,,,,,,,,,,,,,,1,,,,,,
03_蔡佳銘,6th Grade,2025-2026年度 6望,243,1,35,17,,,,5,,,,,,,,,,12,,39,17,11,13,16,,,,,,,,,,,,,,,,,,,,3,,,20,,,,6,,3,,6,,,,,,,,,,,,,15,,,,,4,,,,,,,,,,,,,,,4,,,,3,-1,9,,,,,,,,,,
03_陳希潼,4th Grade,2025-2026年度 4信,130,3,25,11,,,,,,,,,,,,,,1,,15,24,,1,3,,,,,5,,,,,,,,,-3,,,,,6,,,,,,,1,,9,,,,,,,,,,5,,,,,,,,,,,11,,6,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,
03_陳柏銘,6th Grade,2025-2026年度 6信,183,1,35,,3,12,,5,,,2,,,,,,,,,21,49,3,14,3,,-1,,,,,,,,,,,,,,,,,,7,1,,,,3,,,,,4,,,,,,,,,,,,,4,,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,4,,,,,,,
04_AYAT NOOR,1st Grade,2025-2026年度 1信,84,5,10,,,,,,,,,,,,3,,,1,,37,16,2,,3,,,,,,,,,,,-2,-2,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,-1,,,,,,,,,,,,,,,,,,,,,,
04_KHAN MARWA,2nd Grade,2025-2026年度 2信,133,2,,,,,,,,,,50,,3,,,,2,,17,11,5,7,6,,,,,,,,,,10,,,,,,,,,,,,,,,,,,,,,3,1,,,,,,,1,,,,,13,,,1,,1,,,,-1,,,,,,,,,,,,,-1,,,,,,,,,,,2,,,
04_鄭喬之,6th Grade,2025-2026年度 6望,258,6,35,17,,,,5,,,,,,,,,,12,,38,18,11,13,16,,,,,,,,,,,,,,,,,,,,3,,,20,,,,6,,3,,7,,,-6,11,,,,,,,,,12,,,,,4,,,,,,,,,,,,,,,11,,,,3,,8,,,,,,,,,,
04_陳倩婷,6th Grade,2025-2026年度 6信,202,2,35,,3,12,,5,,,2,,,,,,,,,27,49,3,17,6,,-1,,,,,,,,,,,,,,,,,,7,1,,,,,,,,,4,,,,,14,,,,,,,,1,,,,,,3,,,,,,,,,,-1,,,,,,,,,,,,,,3,,,,,,,
04_陳健恒,3rd Grade,2025-2026年度 3信,87,4,,,,,,,,,,,,,,,,,,29,42,2,,3,,,,,,-1,,,,,,,,-1,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,2,,,,,-1,-1,,,,,,,,,,,,,,,,,,,,,,,,,
04_陳煊,4th Grade,2025-2026年度 4信,127,8,25,4,,,,,,,,,,,,,,1,,13,25,,1,2,,,,,5,-5,,-1,5,,,,,-2,,,,,3,,,,,,,,,8,,,,,,,,,,5,,,,,,,,,,,12,,6,,,,,,,,,,,,,,,,,,,,8,,,,4,,,,,
04_陳芷晴,5th Grade,2025-2026年度 5信,249,31,35,,4,,41,,4,,,,,,,,95,3,,8,27,,,,,,,-25,,-2,-3,,,,,,,,,,,,,,,2,,,,,,,,,,,,,,,,,,6,,9,,6,,,4,,3,,,,,,,,,,,,,,,,,,,,-1,,,,,,,,,2,,
05_何梓樂,6th Grade,2025-2026年度 6望,264,6,30,3,,,,10,,,,,1,,,,,8,,36,48,9,13,12,,,,,,,,,,,-2,,,,,,,,,7,,,20,,,,5,,2,9,8,,,-4,6,,,,,,,,,18,,,,,4,,,,,,,,,,,,,,,1,,,,3,,11,,,,,,,,,,
05_周曉彤,3rd Grade,2025-2026年度 3信,28,1,,,,,,,,,,,,,,,,,,11,5,,,1,,,,,,-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
05_張舜堯,5th Grade,2025-2026年度 5信,228,67,35,,4,,18,,,,,,,,,,70,1,,25,26,1,1,3,,,,-45,,-16,-3,,,,,,,,,,,,,,,2,,,,,,,,,,,,,,,,,,10,,12,,7,,,3,,3,,,,,,,,,,,,-1,,,,,,,2,-2,,,,,,,,,5,,
05_簡萬福,2nd Grade,2025-2026年度 2信,143,1,,,,,,,,,,2,1,4,,,,3,,17,10,4,6,5,,,,,,,,,,31,,,,,13,4,9,1,,,,,,,,,,,,,10,1,,,,,,,1,,,,,14,,,1,,2,,,,,,,,,,,,,,,,,-1,,,,,,,,,,,2,,,
05_陳兆楊,6th Grade,2025-2026年度 6信,160,27,35,,2,12,,5,,,2,,,,,,,,-5,30,17,3,19,10,7,-2,,,,-5,,,,,,-2,,,,,,,,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,3,,,-1,,,,-4,-5,,-3,,,,,,,,,,,,,,3,,,,,,,
05_陳耀志,1st Grade,2025-2026年度 1信,86,4,10,,,,,,,,,,,,3,,,1,,29,16,2,,5,,,,,,,,,,,-1,-3,,,,,,,,,,,,,,,,,,17,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
05_陳韋健,4th Grade,2025-2026年度 4信,155,15,25,13,,,,,,,,,,,,,,1,,15,26,,1,3,,,10,,5,-15,,,5,,,,,,,,,,6,,,,,,,,,11,,,,,,,,,,5,,,1,,,,1,,,,11,,5,,,,,,,,,,,,,,,,,,,,8,,,,3,,,,,
06_DALLIGOS JADON PAUL GAENGAN,3rd Grade,2025-2026年度 3信,71,32,,,,,,,,,,,,,,15,,1,,24,15,,2,3,,,,,,-2,,,,,,,,-7,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,2,,,,,-7,-13,,,,,-3,,,,,,,,,,,,,,,,,,,,
06_何俊延,6th Grade,2025-2026年度 6望,145,,30,2,,,,5,,,,,,,,,,5,,19,10,7,8,10,,,,,,,,,,,,,,,,,,,,,,,20,,,,5,,1,,3,,,,,,,,,,,,,10,,,,,4,,,,,,,,,,,,,,,,,,,1,,5,,,,,,,,,,
06_何欣納,1st Grade,2025-2026年度 1信,86,3,10,,,,,,,,,,,,2,,,2,,34,19,1,,1,,,,,,,,,,,-1,-2,,,,,,,,,,,,,,,,,,14,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
06_張瑞均,5th Grade,2025-2026年度 5信,255,31,35,,5,,53,,7,,,,,,,,80,,,12,16,,,,,,,-25,,-1,-3,,,,,,,,,,,,,,,2,,,,,,,,,,,,,6,,,,,8,,11,,6,,,4,,4,,,,,,,,,,,,,,,,,,,,-2,,,,,,,,,6,,
06_林宥聰,2nd Grade,2025-2026年度 2信,123,4,,,,,,,,,,40,,5,,,,2,,15,13,5,7,5,,,,,,,,,,10,,,,,,,,,,,,,,,,,,,,,4,,,,,,,,,,,,,13,,,1,,1,,,,-2,,,,,,,,,,,,,-2,,,,,,,,,,,2,,,
06_陳宪恒,6th Grade,2025-2026年度 6信,152,5,35,,2,12,,5,,,2,,,,,,,,,32,14,3,17,6,2,-1,,,,,,,,,,,,,,,,,,1,1,,,,,5,,,,,,,,,,,,,,,,,1,,,,,,3,,,,,,,-1,-1,,-1,,,-1,,,,,,,,,,,1,,,,,,,
06_陳梓琪,4th Grade,2025-2026年度 4信,157,,25,4,,,,,,,,,,,,,,1,,16,24,,1,3,,,10,,5,,,,5,,,,,,,,,,14,,,,,,,1,,9,,,,,,,,,,5,,,1,,,,,,,,10,,8,,,,,,,,,,,,,,,,,,,,10,,,,5,,,,,
07_張予心,4th Grade,2025-2026年度 4信,163,8,25,4,,,,,,,,,,,,,,1,,19,47,,4,2,,,10,,5,,,,,,,,,-8,,,,,7,,,,,,,,,8,,,,,,,,,,5,,,2,,,,,,,,11,,6,,,,,,,,,,,,,,,,,,,,5,,,,2,,,,,
07_張雅柔,6th Grade,2025-2026年度 6信,182,15,30,,2,12,,5,,,2,,,,,,,,,45,13,3,19,13,14,-1,,,,-10,,,,,,-1,,,,,,,,1,1,,,,,,,,3,,,,,,,,,,,,,,5,,,,,,3,,,-1,,,,,,,-2,,,,,1,,,,,,,,,5,,,,,,,
07_江凱卓,6th Grade,2025-2026年度 6望,259,1,30,17,,,,5,,,,,,,,,,14,,42,18,11,13,17,,,,,,,,,,,-1,,,,,,,,,3,,,20,,,,6,,3,,11,,,,,,,,,,,,,16,,,,,4,,,,,,,,,,,,,,,6,,,,3,,13,,,,,,,,,,
07_簡夏文,3rd Grade,2025-2026年度 3信,33,4,,,,,,,,,,,,,,5,,,,10,6,,,1,,,,,,-1,,,,,,,,-2,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,-1,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
07_羅心慧,2nd Grade,2025-2026年度 2信,178,5,,,,,,,,-3,,77,,3,,,,1,,18,14,4,9,5,,,,,,,,,,7,-1,,,,,,,,,,,,,,,,,,,,10,1,,,,,,,,,,,,24,,,1,,2,,,,,,,,,,,,,,,,,-1,,,,,,,,,,,2,,,
07_莫智雲,1st Grade,2025-2026年度 1信,81,4,10,,,,,,,,,,,,1,,,1,,33,16,2,,3,,,,,,,,,,,-2,-2,,,,,,,,,,,,,,,,,,12,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
07_蔡柏翹,5th Grade,2025-2026年度 5信,232,70,35,,3,,19,,,,,,,,,,80,,,24,19,1,1,4,,,,-65,,,-4,,,,,,,,,,,,,,,2,,,,4,,,,,,,,,,,,,,10,,12,,5,,,4,,4,,,,,,,,,,,,,,,,,,,2,-1,,,,,,,,,3,,
08_劉王耀陽,1st Grade,2025-2026年度 1信,105,2,10,,,,,,,,,,,,5,,,2,,36,22,2,,11,,,,,,,,,,,-1,-1,,,,,,,,,,,,,,,,,,13,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,,,,,,,,,,,,,,,,,1,,,,,,
08_江凱倫,5th Grade,2025-2026年度 5信,235,83,35,,2,,36,,7,,,,,,,,90,,,10,24,,,,,,,-70,,-3,-6,,,,,,,,,,,,,,,1,,-2,,,,,,,,,,,,,,,,6,,10,,6,,,2,,3,,,,,,,,,,,,,,,,,,,,-2,,,,,,,,,3,,
08_簡詩霖,6th Grade,2025-2026年度 6望,242,24,30,17,,,,5,,,,,,,,,,14,,39,17,11,13,15,,,,,,-5,,,,,-5,,,,,,,,,3,,,20,,,,6,,3,,7,,,,,,,,,,,,,15,,,,,5,,,,,,,,,,,,,,,3,,,-8,2,-5,12,,,,,,,,,,-1
08_莊嘉睿,6th Grade,2025-2026年度 6信,147,40,30,,2,12,,,,,2,,,,,,,,,34,13,3,20,8,3,-2,,,,-30,,,,,,-1,,,,,,,,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,3,,,-1,,,,-3,,,-1,,,-1,-1,7,,,,,,,,,3,,,,,,,
08_莊舜然,4th Grade,2025-2026年度 4信,171,,25,6,,,,,,,,,,,,,,1,,14,37,,1,4,,,10,,5,,,,5,,,,,,,,,,13,,,,,,,1,,9,,,,,,,,,,5,,,1,,,,,,,,12,,6,,,,,,,,,,,,,,,,,,,,12,,,,4,,,,,
08_駱俊熙,2nd Grade,2025-2026年度 2信,94,2,,,,,,,,,,1,1,4,,,,,,17,11,4,9,5,,,,,,,,,,17,,,,,3,1,2,,,,,,,,,,,,,,3,,,,,,,,,,,,,12,,,1,,1,,,,,,,,,,,,,,,,,-2,,,,,,,,,,,1,,,
08_高智心,3rd Grade,2025-2026年度 3信,69,23,,,,,,,,,,,,,,10,,,,29,13,,2,4,,,,,,-3,,,,,,,,-1,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,2,,,,,-6,-10,,,,,-3,,,,,,,,,,,,,,,,,,,,
09_劉晞汶,3rd Grade,2025-2026年度 3信,119,15,,,,,,,,,,,,,,20,,,,40,26,,3,10,,,,,,-2,,,,,,,-1,-2,,,,,,,,,,,,,,,,,,,,-8,4,,9,,,,,,,,,,,,2,,,,,-1,,,,,,-1,,,,,,,,,,,,,,,,,,,5,
09_盧芷榆,2nd Grade,2025-2026年度 2信,142,3,,,,,,,,-1,,50,,2,,,,1,,19,13,5,7,6,,,,,,,,,,10,,,,,,,,,,,,,,,,,,,,,8,1,,,,,,,1,,,,,15,,,1,,1,,,,-2,,,,,,,,,,,,,,,,,,,,,,,,2,,,
09_羅一諾,1st Grade,2025-2026年度 1信,103,12,10,,,,,,,,,,,,5,,,4,,27,31,2,,6,,,,,,,,,,,-7,-5,,,,,,,,,,,,,,,,,,15,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
09_詹治霖,5th Grade,2025-2026年度 5信,259,56,35,,4,,18,,,,,,,,,,100,,,31,23,2,3,4,,,,-45,,-1,-4,,,,,,,,,,,,,,,2,,,,,,,,,,,,,,,,,,9,,12,,6,,,2,,3,,,,,,,-3,,,,,,,,,,,,2,-3,,,,,,,,,3,,
09_鍾逸朗,4th Grade,2025-2026年度 4信,168,11,25,13,,,,,,,,,,,,,,1,,20,39,,1,2,,,,,5,,,,5,,,,,,,,,,11,,,,,,,1,,10,,,,,-10,,3,,,5,,,1,,,,,,,,11,,5,,-1,,,,,,,,,,,,,,,,,,6,,,,4,,,,,
09_韓海進,6th Grade,2025-2026年度 6信,193,5,35,,2,12,,5,,,2,,,,,,,,,53,15,3,17,13,5,-1,,,,,,,,,,,,,,,,,,1,1,,,,,,,,,,,,,,,,,,,,,,3,,,,,,3,,,,,,,-2,-1,,-1,,,,,,5,,,,,,,,8,,,,,,,
09_黎梓龍,6th Grade,2025-2026年度 6望,271,2,30,3,,,,10,,,,,,,,,,9,,33,46,9,9,13,,,,,,,,,,,-1,,,,,,,,,7,,,20,,,,5,,23,4,8,,,,8,,,,,,,,,14,,,,-1,5,,,,,,,,,,,,,,,,,,,3,,7,,,,,,,,,,
10_何塱軒,4th Grade,2025-2026年度 4信,116,13,25,5,,,,,,,,,,,,,,1,,13,27,,1,2,,,,,5,-10,,,,,,,,-3,,,,,1,,,,,,,,,9,,,,,,,,,,5,,,,,,,,,,,10,,6,,,,,,,,,,,,,,,,,,,,5,,,,1,,,,,
10_劉恩兒,3rd Grade,2025-2026年度 3信,57,12,,,,,,,,,,,,,,5,,1,,16,13,1,2,2,,,,,,-1,,,,,,,,-2,,,,,,,,,,,,,,,,,,,,-8,6,,9,,,,,,,,,,,,2,,,,,-1,,,,,,,,,,,,,,,,,,,,,,,,,,
10_李善漾,6th Grade,2025-2026年度 6望,311,1,35,16,,,,10,,,,,,,,,,14,,39,59,11,13,16,,,,,,,,,,,,,,,,,,,,7,,,20,,,,7,,5,9,10,,,,,,,,,,,,,17,,,,,7,,,,,,,,,,,,,,,,,,-1,3,,8,,,,,,,,,,
10_李愛莎,2nd Grade,2025-2026年度 2信,115,2,,,,,,,,,,1,,3,,,,,,15,12,4,6,5,,,,,,,,,,26,-2,,,,10,1,8,,,,,,,,,,,,,,5,1,,,,,,,1,,,,,11,,,1,,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,2,,,
10_李泳詩,1st Grade,2025-2026年度 1信,83,2,10,,,,,,,,,,,,4,,,1,,25,16,2,,7,,,,,,,,,,,-1,-1,,,,,,,,,,,,,,,,,,15,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
10_簡莎莉,5th Grade,2025-2026年度 5信,245,46,35,,4,,44,,5,,,,,,,,85,,,7,35,,,,,,,-25,,-1,-3,,,,,,,,,,,,,,,2,,,,,,,,,,,,-16,,,,,,5,,6,,6,,,5,,4,,,,,,,,,,,,,,,,,,,,-1,,,,,,,,,2,,
10_黎玉珊,6th Grade,2025-2026年度 6信,195,1,35,,2,12,,5,,,2,,,,,,,,,54,14,3,21,11,2,-1,,,,,,,,,,,,,,,,,,1,1,,,,,,,,,,,,,,,,,,,,,,2,,,,,,3,,,,,,,,,,,,,,,8,5,,,,,,,,4,,,,,,,
11_MUHAMMAD ESSA,2nd Grade,2025-2026年度 2信,93,11,,,,,,,,-6,,3,,2,,,,,,14,11,4,6,4,,,,,,,,,,15,-4,,,,7,1,4,,,,,,,,,,,,,,4,,,,,,,,1,,,,,12,,,1,,1,,,,,,,,,,,,,,,,,-1,,,,,,,,,,,2,,,
11_劉浚㮾,6th Grade,2025-2026年度 6信,178,12,30,,4,12,,5,,,2,,,,,,,,-2,45,13,3,21,12,7,-3,,,,,,,,,,-2,,,,,,,,1,1,,,,,,,,,,,,,,,,,,,,,,2,,,,,,3,,,,,,,-1,-1,,-1,,,,,,5,,,,,,,-2,2,,,,,,,
11_李雯,3rd Grade,2025-2026年度 3信,65,22,,,,,,,,,,,,,,5,,,,28,19,,,2,,,,,,-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,-16,,,9,,,,,,,,,,,,2,,,,,,-3,,,,,-1,,,,,,,,,,,,,,,,,,,,
11_林俊霖,1st Grade,2025-2026年度 1信,98,3,10,,,,,,,,,,,,3,,,4,,38,17,2,,3,,,,,,,,,,,-1,-1,,,,,,,,,,,,,,,,,,17,,,,,,,,,,,,,,,,,,,1,1,,,,,,,,-1,,,,,,,,,,,,,,,,2,,,,,,
11_梁寶茹,6th Grade,2025-2026年度 6望,238,13,35,18,,,,5,,,,,,,,,,12,,35,17,11,14,16,,,,,,-10,,,,,-1,,,,,,,,,3,,,20,,,,6,,4,,8,,,,,,,,,,,,,12,,,,,4,,,,,,,,,,,,,,,5,,,-1,2,,8,,,,,,,,,,-1
11_簡莉燕,5th Grade,2025-2026年度 5信,225,43,35,,1,,19,,,,,,,,,,100,,,18,8,2,1,3,,,,-30,,-8,-4,,,,,,,,,,,,,,,3,,,,,,,,,,,,,,,,,,9,,12,,6,,,2,,4,,,,,,,,,,,,,,,,,,,1,-1,,,,,,,,,1,,
11_簡邦利,4th Grade,2025-2026年度 4信,152,34,25,15,,,,,,,,,,,,,,1,,14,35,,,3,,,,,5,-20,,,5,,,,,-14,,,,,11,,,,,,,,,11,,,,,,,,,,,,,1,,,,,,,,12,,6,,,,,,,,,,,,,,,,,,,,6,,,,2,,,,,
12_MUHAMMAD WILDAN,2nd Grade,2025-2026年度 2信,124,,,,,,,,,,,50,,2,,,,1,,14,10,4,7,5,,,,,,,,,,10,,,,,,,,,,,,,,,,,,,,,3,2,,,,,,,,,,,,11,,,1,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,2,,,
12_李一樂,6th Grade,2025-2026年度 6信,253,21,30,,7,12,,5,,,2,,,,,,,3,-2,37,61,3,24,2,3,-1,,,,-5,,,,,,-1,,,,,,,,7,1,,,,3,,,,19,3,,,,,6,,,,,,,,,,,,,-4,3,,,-2,,,,-6,,,,,,,,6,,,,,,,,,6,,,,,,,
12_李孝藍,6th Grade,2025-2026年度 6望,282,57,30,3,,,,10,,,,,,,,,,15,,33,48,9,9,13,,,,,,-10,,,,,-14,,,,,,,,,6,,,20,,,,5,,16,10,11,,,,,,,,,,,,,23,,,,-2,6,,,,,,,,,,,,,,,,,,-7,2,-24,13,,,,,,,,,,
12_李祖娜,1st Grade,2025-2026年度 1信,123,5,10,,,,,,,,,,,,6,,,3,,45,21,2,,12,,,,,,,,,,,-3,-2,,,,,,,,,,,,,,,,,,20,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,,,,,,,,,,,,,,,,,1,,,,,,
12_林卓賢,3rd Grade,2025-2026年度 3信,122,18,,,,,,,,,,,,,,15,,,,45,31,,2,8,,,,,,-2,,,,,,,-3,-9,,,,,,,,,,,,,,,,,,,,,,-1,9,,,,,,,,,,,,2,,,,,-1,-2,,,,,,,,,,,,,,,,,,,,,,,,10,
12_林樂然,5th Grade,2025-2026年度 5信,236,101,35,,4,,17,,,,,,,,,,75,1,,26,27,,2,5,,,,-80,,-10,-4,,,,,,,,,,,,,,,2,,,,,,,,,,,,,,,,,,10,,12,,7,,,4,,3,,,,,,,,,,,,,,,,,,-1,3,-6,,,,,,,,,3,,
12_顧晉熙,4th Grade,2025-2026年度 4信,132,4,25,4,,,,,,,,,,,,,,1,,13,21,,1,3,,,10,,5,,,,,,,,,-2,,,,,7,,,,,,,,,12,,,,,-2,,3,,,5,,,,,,,,,,,11,,5,,,,,,,,,,,,,,,,,,,,4,,,,2,,,,,
13_MUHAMMAD MIKAIL KHAN,1st Grade,2025-2026年度 1信,109,2,10,,,,,,,,,,,,6,,,3,,34,25,2,,9,,,,,,,,,,,-1,-1,,,,,,,,,,,,,,,,,,16,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,,,,,,,,,,,,,,,,,1,,,,,,
13_李希晴,6th Grade,2025-2026年度 6信,224,17,30,,5,12,,5,,,2,,,,,,,1,,66,13,3,21,10,13,-1,,,,,,,,,,-1,,,,,,,,1,1,,,,,,,,5,,,,,-6,10,,,,,,,,3,,,,,,3,,,,,,,-5,,,-4,,,,,1,5,,,,,,,,4,,,,,,,
13_李浩彰,6th Grade,2025-2026年度 6望,235,11,30,17,,,,5,,,,,,,,,,13,,38,15,11,13,16,,,,,,-10,,,,,-1,,,,,,,,,1,,,20,,,5,6,,2,,8,,,,,,,,,,,,,15,,,,,4,,,,,,,,,,,,,,,3,,,,2,,9,,,,,,,,,,
13_林幸安,4th Grade,2025-2026年度 4信,167,16,25,9,,,,,,,,,,,,,,1,,18,45,,1,3,,,,,5,,,,5,,,,,-16,,,,,12,,,,,,,,,9,,,,,,,,,,5,,,2,,,,,,,,11,,6,,,,,,,,,,,,,,,,,,,,7,,,,3,,,,,
13_林欣瑶,3rd Grade,2025-2026年度 3信,120,6,,,,,,,,,,,,,,20,,,,52,28,,2,7,,,,,,-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,2,,,,,-1,-4,,,,,,,,,,,,,,,,,,,,,,,,,
13_穆淳,2nd Grade,2025-2026年度 2信,123,2,,,,,,,,,,42,,2,,,,2,,16,12,5,9,6,,,,,,,,,,7,-2,,,,,,,,,,,,,,,,,,,,5,1,,,,,,,1,,,,,11,,,1,,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,2,,,
13_羅家盈,5th Grade,2025-2026年度 5信,234,75,35,,2,,46,,7,,,,,,,,80,,,10,19,,,,,,,-60,,-3,-8,,,,,,,,,,,,,,,2,,-1,,,,,,,,,,,,,,,,8,,11,,5,,,4,,3,,,,,,,,,,,,,,,,,,,,-3,,,,,,,,,2,,
14_吳一帆,1st Grade,2025-2026年度 1信,96,18,10,,,,,,,,,,,,,,,,,33,28,1,,1,,,,,,,,,,,-15,-3,,,,,,,,,,,,,,,,,,19,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,,,,,,,,,,,,,,,,,1,,,,,,
14_吳柏熹,2nd Grade,2025-2026年度 2信,52,,,,,,,,,,,1,,,,,,,,9,7,3,5,4,,,,,,,,,,6,,,,,,,,,,,,,,,,,,,,,2,,,,,,,,,,,,,11,,,1,,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,2,,,
14_李雨晨,5th Grade,2025-2026年度 5信,245,83,35,,2,,45,,7,,,,,,,,90,,,11,18,,,,,,,-60,,-6,-10,,,,,,,,,,,,,,,2,,-1,,,,,,,,,,,,,,,,8,,11,,6,,,3,,3,,,,,,,,,,,,,,,,,,-3,,-3,,,,,,,,,4,,
14_林梓瀚,6th Grade,2025-2026年度 6望,252,18,30,23,,,,5,,,,,,,,,,12,,37,19,11,13,17,,,,,,,,,,,-8,,,,,,,,,3,,,20,,,,6,,3,,7,,,,,,,,,,,,,14,,,,,4,,,,,,,,,,,,-1,,,6,,,-2,1,-2,13,,,,,,-3,,,,-2
14_林沚含,3rd Grade,2025-2026年度 3信,73,12,,,,,,,,,,,,,,10,,,,30,15,,2,5,,,,,,-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,2,,,,,-3,-8,,,,,,,,,,,,,,,,,,,,,,,,,
14_梁洛銘,4th Grade,2025-2026年度 4信,177,2,25,7,,,,,,,,,,,,,,1,,15,50,,1,3,,,10,,5,,,,5,,,,,-2,,,,,6,,,,,,,1,,10,,,,,,,,,,5,,,2,,,,,,,,12,,6,,,,,,,,,,,,,,,,,,,,9,,,,4,,,,,
14_麥杏妮,6th Grade,2025-2026年度 6信,170,5,35,,2,12,,5,,,2,,,,,,,3,,36,15,3,20,8,11,-1,,,,,,,,,,,,,,,,,,1,1,,,,,,,,,,,,,,,,,,,,,,1,,,,,,3,,,-1,,,,-2,,,-1,,,,,,,,,,,,,,2,,,,,,,
15_MUHAMMAD,4th Grade,2025-2026年度 4信,122,14,25,7,,,,,,,,,,,,,,1,,9,23,,1,3,,,,,5,,,,,,,,,-14,,,,,7,,,,,,,,,11,,,,,,,,,,,,,1,,,,,,,,11,,7,,,,,,,,,,,,,,,,,,,,9,,,,2,,,,,
15_MUHAMMAD ABEESHA,3rd Grade,2025-2026年度 3信,47,3,,,,,,,,,,,,,,10,,,,15,10,,,1,,,,,,-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,2,,,,,-1,,,,,,,,,,,,,,,,,,,,,,,,,,
15_ORIT PRINCESS RENELENE,2nd Grade,2025-2026年度 2信,135,15,,,,,,,,-2,,2,,1,,,,1,,20,13,3,9,4,,,,,,,,,,31,-7,,,,8,1,6,,,,,,,,,,,,,,3,1,,,,,,,,,,,,26,,,1,,2,,,,-3,,,,,,,,,,,,,-3,,,,,,,,,,,2,,,
15_彭天朗,1st Grade,2025-2026年度 1信,102,2,10,,,,,,,,,,,,5,,,1,,34,20,2,,8,,,,,,,,,,,-1,-1,,,,,,,,,,,,,,,,,,18,,,,,,,,,,,,,,,,,,,1,1,,,,,,,,,,,,,,,,,,,,,,,,2,,,,,,
15_成葭弦,6th Grade,2025-2026年度 6信,160,9,35,,2,12,,5,,,2,,,,,,,,-2,35,12,3,19,11,7,-1,,,,,,,,,,-1,,,,,,,,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,3,,,-1,,,,-1,,,-3,,,,,,,,,,,,,,2,,,,,,,
15_盧若林,6th Grade,2025-2026年度 6望,243,,30,17,,,,5,,,,,,,,,,12,,37,17,11,13,16,,,,,,,,,,,,,,,,,,,,3,,,20,,,,6,,3,,7,,,,,,,,,,,,,14,,,,,4,,,,,,,,,,,,,,,8,,,,6,,7,,,,,,,,,,
15_麥心怡,5th Grade,2025-2026年度 5信,214,40,35,,3,,18,,,,,,,,,,75,,,21,19,1,1,3,,,,-30,,-5,-3,,,,,,,,,,,,,,,1,,,,,,,,,,,,,,,,,,9,,12,,6,,,3,,3,,,,,,,,,,,,,,,,,,,2,-2,,,,,,,,,2,,
16_MUHAMMAD KHAWLAH,4th Grade,2025-2026年度 4信,131,6,25,14,,,,,,,,,,,,,,1,,12,19,,,4,,,,,5,-5,,,,,,,,,,,,,6,,,,,,,,,8,,,,,,,,,,5,,,1,,,,1,,,,11,,5,,-1,,,,,,,,,,,,,,,,,,12,,,,2,,,,,
16_冼昱君,1st Grade,2025-2026年度 1信,81,4,10,,,,,,,,,,,,2,,,1,,27,17,2,,3,,,,,,,,,,,-1,-3,,,,,,,,,,,,,,,,,,16,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
16_施雯霞,3rd Grade,2025-2026年度 3信,72,19,,,,,,,,,,,,,,10,,,,25,20,,,2,,,,,,-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,-12,4,,9,,,,,,,,,,,,2,,,,,-1,-2,,,,,-2,,,,,,,,,,,,,,,,,,,,
16_潘子瑜,2nd Grade,2025-2026年度 2信,129,,,,,,,,,,,1,,3,,,,1,,19,10,4,5,5,,,,,,,,,,30,,,,,13,1,8,,,,,,,,,,,,,,7,1,,,,,,,1,,,,,14,,,1,,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,2,,,
16_穆文祥,5th Grade,2025-2026年度 5信,246,30,35,,3,,53,,4,,,,,,,,90,,,10,16,,,,,,,-25,,,-4,,,,,,,,,,,,,,,1,,,,,,,,,,,,,,,,,,6,,10,,8,,,4,,3,,,,,,,,,,,,,,,,,,,,-1,,,,,,,,,3,,
16_蘇穎熙,6th Grade,2025-2026年度 6信,188,9,35,,2,12,,5,,,2,,,,,,,,,50,17,3,19,9,,-2,,,,,,,,,,-1,,,,,,,,1,1,,,,3,,,,,9,,,,,,,,,,,,,,,,,,,3,,,,,,,,-2,,-1,,,-1,-2,,,,,,,,,,7,,,,,,,
16_魏芯悅,6th Grade,2025-2026年度 6望,258,16,35,17,,,,5,,,,,,,,,,12,,40,17,11,16,15,,,,,,,,,,,,,,,,,,,,3,,,20,,,,6,,3,,9,,,-16,4,,,,,,,,,14,,,,,4,,,,,,,,,,,,,,,3,,,,4,,10,,,,,,,,,,
17_MUHAMMAD DANIAL,5th Grade,2025-2026年度 5信,183,113,35,,1,,14,,,,,,,,,,65,,,19,15,1,1,1,,,,-80,,-14,-6,,,,,,,,,,,,,,,2,,-2,,,,,,,,,,,,,,,,6,,10,,5,,,,,3,,,,,,,-6,,,,,,,,,,,-1,1,-4,,,,,,,,,4,,
17_吳煥揚,4th Grade,2025-2026年度 4信,145,1,25,10,,,,,,,,,,,,,,1,,14,19,,1,3,,,10,,5,,,,5,,,,,,,,,,5,,,,,,,,,9,,,,,,,,,,5,,,,,,,1,,,,11,,6,,-1,,,,,,,,,,,,,,,,,,11,,,,4,,,,,
17_施文森,6th Grade,2025-2026年度 6信,160,5,30,,2,12,,5,,,2,,,,,,,,,36,14,3,17,10,7,-1,,,,,,,,,,-3,,,,,,,,1,1,,,,,2,,,,,,,,,,,,,,,,,5,,,,,,3,,,,,,,-1,,,,,,,,,,,,,,,,,5,,,,,,,
17_潘俙曈,2nd Grade,2025-2026年度 2信,131,2,,,,,,,,,,48,,2,,,,1,,19,12,5,7,6,,,,,,,,,,10,,,,,,,,,,,,,,,,,,,,,5,,,,,,,,1,,,,,11,,,1,,1,,,,,,,,,,,,,,,,,-2,,,,,,,,,,,2,,,
17_潘芯瑤,6th Grade,2025-2026年度 6望,252,,35,17,,,,5,,,,,,,,,,12,,39,18,11,13,17,,,,,,,,,,,,,,,,,,,,3,,,20,,,,6,,3,,9,,,,,,,,,,,,,14,,,,,4,,,,,,,,,,,,,,,5,,,,5,,8,,,,,,,,,,
17_葉栩瑜,1st Grade,2025-2026年度 1信,116,3,10,,,,,,,,,,,,4,,,3,,44,28,2,,3,,,,,,,,,,,-1,-2,,,,,,,,,,,,,,,,,,18,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,,,,,,,,,,,,,,,,,1,,,,,,
17_蘇穎嘉,3rd Grade,2025-2026年度 3信,80,10,,,,,,,,,,,,,,15,,,,25,28,,,1,,,,,,-3,,,,,,,,-6,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,2,,,,,,-1,,,,,,,,,,,,,,,,,,,,,,,,,
18_丁嘉鈮,6th Grade,2025-2026年度 6信,215,1,35,,3,12,,5,,,2,,,,,,,,,30,51,3,18,7,3,-1,,,,,,,,,,,,,,,,,,7,1,,,,,,,,6,10,,,,,,,,,,,,,1,,,,,,3,,,,,,,,,,,,,,,1,,,,,,,,,7,,,,,,,
18_冼天逸,2nd Grade,2025-2026年度 2信,114,10,,,,,,,,-1,,2,,2,,,,,,15,10,3,9,4,,,,,,,,,,23,-7,,,,8,3,7,1,,,,,,,,,,,,,5,1,,,,,,,,,,,,15,,,1,,1,,,,-2,,,,,,,,,,,,,,,,,,,,,,,,2,,,
18_孫卓翹,5th Grade,2025-2026年度 5信,218,53,35,,3,,15,,,,,,,,,,75,,,20,23,1,1,2,,,,-25,,-3,-4,,,,,,,,,,,,,,,2,,,,,,,,,,,,-16,6,,,,,8,,11,,6,,,2,,3,,,,,,,-3,,,,,,,,,,,,3,-2,,,,,,,,,2,,
18_潘子城,4th Grade,2025-2026年度 4信,162,2,25,10,,,,,,,,,,,,,,1,,19,42,,1,3,,,5,,10,,,,,,,,,-2,,,,,3,,,,,,,,,9,,,,,,,,,,5,,,,,,,,,,,11,,6,,,,,,,,,,,,,,,,,,,,8,,,,4,,,,,
18_譚偉奇,3rd Grade,2025-2026年度 3信,73,18,,,,,,,,,,,,,,15,,,,23,18,,2,4,,,,,,-2,,,,,,,,-1,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,2,,,,,-11,-2,,,,,-2,,,,,,,,,,,,,,,,,,,,
18_金善美,1st Grade,2025-2026年度 1信,93,2,10,,,,,,,,,,,,4,,,3,,39,16,2,,3,,,,,,,,,,,-1,-1,,,,,,,,,,,,,,,,,,13,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
18_黃卓明,6th Grade,2025-2026年度 6望,262,1,35,20,,,,5,,,,,,,,,,12,,41,17,11,13,17,,,,,,,,,,,-1,,,,,,,,,3,,,20,,,4,6,,4,,8,,,,,,,,,,,,,14,,,,,4,,,,,,,,,,,,,,,7,,,,4,,9,,,,,,,,,,
19_唐澤明,2nd Grade,2025-2026年度 2信,122,9,,,,,,,,-1,,1,,3,,,,1,,18,12,4,7,7,,,,,,,,,,26,-5,,,,9,1,6,,,,,,,,,,,,,,7,1,,,,,,,,,,,,13,,,2,,2,,,,,,,,,,,,,,,,,-3,,,,,,,,,,,2,,,
19_張穎,1st Grade,2025-2026年度 1信,124,2,10,,,,,,,,,,,,4,,,3,,45,25,2,,14,,,,,,,,,,,-1,-1,,,,,,,,,,,,,,,,,,17,,,,,,,,,,,,,,,,,,,1,2,,,,,,,,,,,,,,,,,,,,,,,,1,,,,,,
19_曾浩蘴,5th Grade,2025-2026年度 5信,180,94,35,,3,,10,,,,,,,,,,75,,,17,9,,1,1,,,,-65,,-11,-4,,,,,,,,,,,,,,,1,,,,,,,,,,,,,,,,,,6,,9,,5,,,3,,3,,,,,,,-12,,,,,,,,,,,,,-2,,,,,,,,,2,,
19_杜烙謙,3rd Grade,2025-2026年度 3信,52,18,,,,,,,,,,,,,,,,,,20,14,,,1,,,,,,-1,,,,,,,-2,-10,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,-4,,,2,,,,,,-1,,,,,,,,,,,,,,,,,,,,,,,,6,
19_潘晟睿,4th Grade,2025-2026年度 4信,202,1,25,15,,,,,,,,,,,,,,2,,20,67,,1,3,,,,,5,,,,5,,,,,-1,,,,,6,,,,,,,1,,12,,,,,,,,,,5,,,,,,,1,,,,11,,7,,,,,,,,,,,,,,,,,,,,9,,,,7,,,,,
19_黃思婷,6th Grade,2025-2026年度 6信,164,11,35,,3,12,,5,,,2,,,,,,,1,,39,15,3,18,11,1,-1,,,,-10,,,,,,,,,,,,,,1,1,,,,,,,,2,,,,,,,,,,,,,,5,,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,2,,,,,,,
19_黃海晴,6th Grade,2025-2026年度 6望,279,,35,7,,,,10,,,,,1,,,,,9,,37,47,8,12,14,,,,,,,,,,,,,,,,,,,,8,,,20,,,,5,,2,3,6,,,,16,,,,,,,,,16,,,,,4,,,,,,,,,,,,,,,2,,,,3,,9,,,,,,,,,,
20_SAMAVIA BIBI,4th Grade,2025-2026年度 4信,118,18,25,5,,,,,,,,,,,,,,1,,11,22,,1,3,,,,,5,-15,,,,,,,,-2,,,,,3,,,,,,,,,8,,,,,,,,,,5,,,,,,,,,,,11,,5,,-1,,,,,,,,,,,,,,,,,,10,,,,3,,,,,
20_VILLENA JOHN ANGELO GERMIA,5th Grade,2025-2026年度 5信,242,54,35,,2,,40,,7,,,,,,,,85,,,15,19,,1,2,,,,-35,,-8,-10,,,,,,,,,,,,,,,2,,,,,,,,,,,,,,,,,,9,,11,,5,,,2,,3,,,,,,,,,,,,,,,,,,,,-1,,,,,,,,,4,,
20_吳詠兒,6th Grade,2025-2026年度 6望,267,,35,17,,,,5,,,,,,,,,,15,,46,19,12,18,16,,,,,,,,,,,,,,,,,,,,3,,,20,,,,6,,3,,9,,,,,,,,,,,,,16,,,,,5,,,,,,,,,,,,,,,6,,,,2,,7,,,,,,,,,,
20_湯奈莉,3rd Grade,2025-2026年度 3信,85,9,,,,,,,,,,,,,,15,,,,34,19,,2,4,,,,,,-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,2,,,,,,-6,,,,,-1,,,,,,,,,,,,,,,,,,,,
20_許鎧宇,1st Grade,2025-2026年度 1信,29,2,10,,,,,,,,,,,,,,,1,,6,6,1,,2,,,,,,,,,,,-1,-1,,,,,,,,,,,,,,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
20_黃思維,2nd Grade,2025-2026年度 2信,134,2,,,,,,,,,,50,,2,,,,2,,19,12,5,7,6,,,,,,,,,,10,,,,,,,,,,,,,,,,,,,,,5,,,,,,,,2,,,,,11,,,1,,1,,,,,,,,,,,,,,,,,-2,,,,,,,,,,,1,,,
20_黃文彤,6th Grade,2025-2026年度 6信,169,16,35,,3,12,,,,,2,,,,,,,,-2,23,49,3,12,4,,-1,,,,-10,,,,,,,,,,,,,,7,1,,,,,,,,,,,,,,,,,,,,,,3,,,,,,3,,,,,,,,,,,,,-1,-2,,,,,,,,,,7,,,,,,,
21_冼健文,6th Grade,2025-2026年度 6望,232,1,35,5,,,,5,,,,,,,,,,8,,32,15,8,9,13,,,,,,,,,,,,,,,,,,,,3,,,20,,,5,5,,3,,13,,,,,,,,,,,,,18,,,,,5,,,,,,,,,,,,-1,,,5,,,,3,,15,,,,,,,,,,
21_王棋允,5th Grade,2025-2026年度 5信,263,53,35,,3,,51,,6,,,,,,,,90,,,13,24,,,,,,,-40,,-5,-5,,,,,,,,,,,,,,,2,,,,5,,,,,,,,,,,,,,9,,11,,5,,,3,,3,,,,,,,,,,,,,,,,,,,,-3,,,,,,,,,3,,
21_聶伽琪,4th Grade,2025-2026年度 4信,114,,25,6,,,,,,,,,,,,,,1,,11,22,,1,4,,,,,5,,,,,,,,,,,,,,5,,,,,,,,,8,,,,,,,,,,,,,,,,,,,,,10,,6,,,,,,,,,,,,,,,,,,,,8,,,,2,,,,,
21_葉杜娟,2nd Grade,2025-2026年度 2信,133,3,,,,,,,,,,46,,4,,,,1,,20,12,5,7,6,,,,,,,,,,10,,,,,,,,,,,,,,,,,,,,,4,1,,,,,,,,,,,,13,,,1,,1,,,,-1,,,,,,,,,,,,,-2,,,,,,,,,,,2,,,
21_蔡思翰,3rd Grade,2025-2026年度 3信,144,7,,,,,,,,,,,,,,25,,,,48,30,,2,10,,,,,,-1,,,,,,,,-1,,,,,,,,,,,,,,,,,,,,-4,6,,9,,,,,,,,,,,,2,,,,,,-1,,,,,,,,,,,,,,,,,,,,,,,,12,
21_黃耀光,6th Grade,2025-2026年度 6信,215,12,30,,2,12,,5,,,2,,,,,,,,-3,60,17,3,19,11,12,-1,,,,,,,,,,-1,,,,,,,,1,1,,,,,5,,,2,,,,,,,,,,,,,,3,,,,,,3,,,,,,,-2,,,,,,,,1,5,,,,,,,-5,11,,,,,,,
22_吴漫棋,3rd Grade,2025-2026年度 3信,55,4,,,,,,,,,,,,,,10,,,,19,14,,,1,,,,,,-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,2,,,,,-1,-1,,,,,-1,,,,,,,,,,,,,,,,,,,,
22_張家如,2nd Grade,2025-2026年度 2信,82,4,,,,,,,,,,1,,,,,,,,14,11,4,5,4,,,,,,,,,,16,,,,,5,,1,,,,,,,,,,,,,,4,,,,,,,,,,,,,12,,,1,,1,,,,-2,,,,,,,,,,,,,-2,,,,,,,,,,,2,,,
22_王嘉苑,5th Grade,2025-2026年度 5信,220,33,35,,4,,20,,,,,,,,,,80,,,23,11,2,2,3,,,,-25,,-3,-3,,,,,,,,,,,,,,,2,,,,,,,,,,,,,,,,,,8,,10,,6,,,4,,4,,,,,,,,,,,,,,,,,,,3,-2,,,,,,,,,3,,
22_王焌穎,4th Grade,2025-2026年度 4信,169,10,25,12,,,,,,,,,,,,,,1,,17,50,,1,3,,,,,5,,,,5,,,,,-6,,,,,5,,,,,,,1,,11,,,,,-2,,5,,,5,,,,,,,,,,,11,,5,,-2,,,,,,,,,,,,,,,,,,4,,,,3,,,,,
22_英樂怡,6th Grade,2025-2026年度 6望,253,,35,17,,,,5,,,,,,,,,,12,,40,18,11,13,16,,,,,,,,,,,,,,,,,,,,3,,,20,,,5,6,,3,,6,,,,,,,,,,,,,13,,,,,5,,,,,,,,,,,,,,,6,,,,5,,9,,,,,,,,,,
22_葉辰丁,6th Grade,2025-2026年度 6信,166,27,30,,4,12,,,,,2,,,,,,,1,-2,45,14,3,21,10,4,-6,,-10,,,,,,,,-2,,,,,,,,1,1,,,,,,,,2,,,,,,,,,,,,,,,,,,,,3,,,,,,,-2,-1,,-4,,,,,,,,,,,,,,3,,,,,,,
23_張佑文,3rd Grade,2025-2026年度 3信,83,51,,,,,,,,,,,,,,10,,,,33,15,,2,4,,,,,,-3,,,,,,,-4,-31,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,-1,,,2,,,,,-3,-8,,,,,-1,,,,,,,,,,,,,,,,,,,8,
23_楊文悦,5th Grade,2025-2026年度 5信,200,30,35,,3,,14,,,,,,,,,,75,,,18,18,,1,2,,,,-25,,-1,-3,,,,,,,,,,,,,,,2,,,,,,,,,,,,,,,,,,7,,9,,6,,,4,,4,,,,,,,,,,,,,,,,,,,1,-1,,,,,,,,,1,,
23_陳子喬,2nd Grade,2025-2026年度 2信,136,1,,,,,,,,,,47,,2,,,,1,,17,12,5,7,6,,,,,,,,,,10,,,,,,,,,,,,,,,,,,,,,7,1,,,,,,,1,,,,,14,,,1,,3,,,,,,,,,,,,,,,,,-1,,,,,,,,,,,2,,,
23_黃裕軒,4th Grade,2025-2026年度 4信,143,1,25,4,,,,,,,,,,,,,,1,,16,24,,,5,,,,,5,,,-1,5,,,,,,,,,,12,,,,,,,,,8,,,,,,,,,,5,,,1,,,,,,,,10,,6,,,,,,,,,,,,,,,,,,,,12,,,,4,,,,,
24_張瑩,3rd Grade,2025-2026年度 3信,92,1,,,,,,,,,,,,,,10,,,,30,26,,,3,,,,,,-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,12,
24_楊以靜,4th Grade,2025-2026年度 4信,131,1,25,4,,,,,,,,,,,,,,2,,14,20,,1,3,,,,,5,,,,5,,,,,-1,,,,,8,,,,,,,,,9,,,,,,,,,,5,,,,,,,,,,,11,,6,,,,,,,,,,,,,,,,,,,,10,,,,3,,,,,
24_楊王健,5th Grade,2025-2026年度 5信,215,36,35,,6,,18,,,,,,,,,,75,,,19,14,2,1,3,,,,-30,,,-3,,,,,,,,,,,,,,,2,,,,,,,,,,,,,,,,,,10,,12,,6,,,4,,4,,,,,,,,,,,,,,,,,,,2,-3,,,,,,,,,2,,
25_英樂健,4th Grade,2025-2026年度 4信,160,14,25,13,,,,,,,,,,,,,,1,,17,37,,1,3,,,,,5,-5,,,5,,,,,-5,,,,,4,,,,,,,1,,12,,,,,,,,,,5,,,1,,,,,,,,10,,11,,-4,,,,,,,,,,,,,,,,,,7,,,,2,,,,,
25_葉梓揚,5th Grade,2025-2026年度 5信,207,123,35,,4,,12,,1,,,,,,,,80,1,,20,11,1,1,3,,,,-110,,,-5,,,,,,,,,,,,,,,2,,-1,,,,,,,,,,,,,,,,8,,10,,7,,,4,,3,,,,,,,-3,,,,,,,,,,,,2,-4,,,,,,,,,2,,
25_金善雅,3rd Grade,2025-2026年度 3信,51,29,,,,,,,,,,,,,,5,,,,17,12,,2,4,,,,,,-1,,,,,,,,-12,,,,,,,,,,,,,,,,,,,,,,-2,9,,,,,,,,,,,,2,,,,,-7,-6,,,,,-1,,,,,,,,,,,,,,,,,,,,
26_余健仕,5th Grade,2025-2026年度 5信,250,65,35,,3,,43,,7,,,,,,,,90,,,11,20,,,,,,,-50,,,-10,,,,,,,,,,,,,,,2,,,,4,,,,,,,,,,,,,,9,,11,,5,,,3,,3,,,,,,,,,,,,,,,,,,-1,,-4,,,,,,,,,4,,
26_劉王耀康,3rd Grade,2025-2026年度 3信,91,5,,,,,,,,,,,,,,5,,,,31,32,,2,4,,,,,,-2,,,,,,,,-1,,,,,,,,,,,,,,,,,,,,,,,9,,,,,,,,,,,,2,,,,,,-2,,,,,,,,,,,,,,,,,,,,,,,,6,
26_張嘉豪,4th Grade,2025-2026年度 4信,147,1,25,11,,,,,,,,,,,,,,1,,15,25,,1,3,,,10,,5,,,,5,,,,,,,,,,5,,,,,,,,,9,,,,,,,,,,5,,,1,,,,,,,,10,,5,,-1,,,,,,,,,,,,,,,,,,8,,,,3,,,,,
27_MUHAMMAD SABELLA S.KHAN,4th Grade,2025-2026年度 4信,157,3,25,19,,,,,,,,,,,,,,1,,15,25,,1,3,,,,,5,,,,5,,,,,,,,,,6,,,,,,,,,11,,,,,,,,,,5,,,2,,,,1,,,,11,,7,,-3,,,,,,,,,,,,,,,,,,10,,,,5,,,,,
27_張浩文,5th Grade,2025-2026年度 5信,203,56,35,,3,,25,,5,,,,,,,,80,,,7,16,,,,,,,-45,,-3,-5,,,,,,,,,,,,,,,2,,,,,,,,,,,,,,,,,,7,,10,,5,,,3,,3,,,,,,,,,,,,,,,,,,,,-3,,,,,,,,,2,,

        `;
        
        // ----------------------------------------------------
        // 2. 變數聲明與數據處理
        // ----------------------------------------------------
        const PAGE_SIZE = 5; // 每頁顯示學生數
        let allClassRankings = {};
        
        // DOM 元素
        const rankingListEl = document.getElementById('ranking-list');
        const classTitleEl = document.getElementById('class-title');
        const pageIndicatorEl = document.getElementById('page-indicator');
        const errorMessageEl = document.getElementById('error-message');
        const classNavLinksEl = document.getElementById('class-nav-links');
        const paginationControlsEl = document.getElementById('pagination-controls');

        /**
         * 解析 CSV 數據，計算總分，並按班級分組。
         */
        function processData() {
            const lines = csvData.trim().split('\n');
            if (lines.length < 2) return {};

            // 提取標頭
            const headers = lines[0].split(',');
            const dataLines = lines.slice(1);

            const CLASS_INDEX = headers.indexOf('Classes');
            const POSITIVE_INDEX = headers.indexOf('Positive');
            const NEEDS_WORK_INDEX = headers.indexOf('Needs Work');

            if (CLASS_INDEX === -1 || POSITIVE_INDEX === -1 || NEEDS_WORK_INDEX === -1) {
                console.error("CSV 標頭缺失: Classes, Positive, 或 Needs Work.");
                return {};
            }

            const classData = {};

            dataLines.forEach(line => {
                // 使用正則表達式來處理 CSV 逗號分隔符，避免名字中包含逗號的問題
                const values = line.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g) || [];

                const rawClass = values[CLASS_INDEX] ? values[CLASS_INDEX].replace(/"/g, '') : '';
                const positive = parseInt(values[POSITIVE_INDEX]) || 0;
                const needsWork = parseInt(values[NEEDS_WORK_INDEX]) || 0;

                // 簡化班級名稱: "2025-2026年度 3信" -> "3信"
                const classNameMatch = rawClass.match(/\s(\d\S+)$/);
                const className = classNameMatch ? classNameMatch[1] : rawClass;

                const totalScore = positive - needsWork;

                const student = {
                    name: values[0].replace(/"/g, ''), // 清理名稱中的引號
                    positive,
                    needsWork,
                    totalScore,
                    className
                };

                // 僅處理有有效班級名稱的數據
                if (className) {
                    if (!classData[className]) {
                        classData[className] = [];
                    }
                    classData[className].push(student);
                }
            });

            // 對每個班級進行排名 (總分降序)
            for (const className in classData) {
                classData[className].sort((a, b) => b.totalScore - a.totalScore);

                // 計算排名 (處理並列排名)
                classData[className].forEach((student, index, arr) => {
                    if (index > 0 && student.totalScore === arr[index - 1].totalScore) {
                        // 與前一個學生分數相同，排名相同
                        student.rank = arr[index - 1].rank;
                    } else {
                        // 新排名 (名次 = 索引 + 1)
                        student.rank = index + 1;
                    }
                });
            }

            return classData;
        }

        // ----------------------------------------------------
        // 3. 渲染 UI 核心
        // ----------------------------------------------------
        
        /**
         * 渲染分頁控制按鈕。
         * @param {string} className - 當前班級名稱。
         * @param {number} currentPage - 當前頁碼。
         * @param {number} totalPages - 總頁數。
         */
        function renderPaginationControls(className, currentPage, totalPages) {
            paginationControlsEl.innerHTML = '';
            
            const encodedClassName = encodeURIComponent(className);

            const prevDisabled = currentPage === 1;
            const nextDisabled = currentPage === totalPages;

            const prevHash = `#${encodedClassName}/${currentPage - 1}`;
            const nextHash = `#${encodedClassName}/${currentPage + 1}`;

            const baseClasses = "py-2 px-4 rounded-full font-bold shadow-md transition duration-200";
            const enabledClasses = "bg-blue-500 text-white hover:bg-blue-600 active:bg-blue-700";
            const disabledClasses = "bg-gray-300 text-gray-500 cursor-not-allowed";

            // 上一頁按鈕
            const prevButton = `<a href="${prevDisabled ? '#' : prevHash}" class="${baseClasses} ${prevDisabled ? disabledClasses : enabledClasses}">
                ← 上一頁
            </a>`;

            // 下一頁按鈕
            const nextButton = `<a href="${nextDisabled ? '#' : nextHash}" class="${baseClasses} ${nextDisabled ? disabledClasses : enabledClasses}">
                下一頁 →
            </a>`;

            paginationControlsEl.insertAdjacentHTML('beforeend', prevButton);
            paginationControlsEl.insertAdjacentHTML('beforeend', nextButton);
        }

        /**
         * 渲染班級導航連結。
         * @param {string} currentClassName - 當前班級名稱。
         */
        function renderClassNavLinks(currentClassName) {
            classNavLinksEl.innerHTML = '';
            const classNames = Object.keys(allClassRankings);

            classNames.forEach(className => {
                const isCurrent = className === currentClassName;
                const encodedClassName = encodeURIComponent(className);
                const buttonClasses = isCurrent
                    ? 'bg-red-500 text-white shadow-xl'
                    : 'bg-white text-gray-700 hover:bg-gray-100 shadow-md';
                
                const link = `
                    <a href="#${encodedClassName}/1" class="py-2 px-4 text-sm rounded-full font-semibold transition duration-200 ${buttonClasses}">
                        ${className}
                    </a>
                `;
                classNavLinksEl.insertAdjacentHTML('beforeend', link);
            });
        }


        /**
         * 根據 URL Hash 渲染特定班級的排名。
         */
        function renderClassRanking() {
            // 1. 處理 Hash
            const hash = window.location.hash.substring(1); // e.g., "3信/2"
            const parts = hash.split('/');
            
            // 嘗試從 Hash 獲取班級名稱，否則使用第一個班級
            const defaultClassName = Object.keys(allClassRankings)[0];
            const rawClassName = parts[0] || defaultClassName;
            const currentClassName = decodeURIComponent(rawClassName);
            
            // 獲取頁碼，確保至少是 1
            const requestedPage = parseInt(parts[1] || '1', 10);
            
            rankingListEl.innerHTML = '';
            paginationControlsEl.innerHTML = '';
            errorMessageEl.classList.add('hidden');

            const classStudents = allClassRankings[currentClassName];

            if (!classStudents || classStudents.length === 0) {
                // 找不到班級或數據
                classTitleEl.textContent = '❌ 數據載入失敗';
                pageIndicatorEl.textContent = '';
                errorMessageEl.classList.remove('hidden');
                renderClassNavLinks(currentClassName);
                return;
            }

            const totalStudents = classStudents.length;
            const totalPages = Math.ceil(totalStudents / PAGE_SIZE);

            // 確保頁碼有效
            const currentPage = Math.max(1, Math.min(requestedPage, totalPages));

            // 2. 數據分頁
            const start = (currentPage - 1) * PAGE_SIZE;
            const end = start + PAGE_SIZE;
            const studentsToDisplay = classStudents.slice(start, end);

            // 3. 更新標題和頁碼指示器
            classTitleEl.textContent = currentClassName + ' 🥳';
            pageIndicatorEl.textContent = `第 ${currentPage} 頁 / 共 ${totalPages} 頁`;

            // 4. 渲染學生排名
            studentsToDisplay.forEach(student => {
                const isFirst = student.rank === 1;
                const isSecond = student.rank === 2;
                const isThird = student.rank === 3;

                // 根據排名設定不同的顏色和風格
                let bgColor = 'bg-white';
                let borderColor = 'border-gray-300';
                let rankColor = 'text-gray-600';
                let rankText = student.rank;

                if (isFirst) {
                    bgColor = 'bg-yellow-300';
                    borderColor = 'border-4 border-red-500';
                    rankColor = 'text-red-600';
                    rankText = '🥇';
                } else if (isSecond) {
                    bgColor = 'bg-gray-300';
                    borderColor = 'border-4 border-gray-500';
                    rankColor = 'text-gray-700';
                    rankText = '🥈';
                } else if (isThird) {
                    bgColor = 'bg-amber-300';
                    borderColor = 'border-4 border-orange-500';
                    rankColor = 'text-orange-600';
                    rankText = '🥉';
                } else {
                    bgColor = 'bg-white';
                    borderColor = 'border-2 border-green-500';
                }

                const rankHtml = `
                    <div class="rank-card ${bgColor} ${borderColor} p-3 sm:p-4 rounded-xl shadow-lg flex items-center transform hover:scale-[1.01] transition duration-300">
                        <!-- 排名徽章 -->
                        <div class="w-12 h-12 sm:w-16 sm:h-16 flex-shrink-0 flex items-center justify-center font-extrabold text-2xl sm:text-3xl rounded-full ${isFirst || isSecond || isThird ? 'bg-white' : 'bg-green-100'} ${rankColor} shadow-inner border-2 border-current">
                            ${rankText}
                        </div>
                        
                        <!-- 學生資訊 -->
                        <div class="flex-grow ml-4">
                            <p class="text-lg sm:text-xl font-bold text-blue-800">${student.name}</p>
                            <p class="text-sm sm:text-base text-gray-500">Positive: ${student.positive} / Needs Work: ${student.needsWork}</p>
                        </div>
                        
                        <!-- 總分 -->
                        <div class="flex-shrink-0 text-right">
                            <p class="text-xl sm:text-2xl font-black text-green-700 leading-none">總分</p>
                            <p class="text-3xl sm:text-4xl font-black text-red-500">${student.totalScore}</p>
                        </div>
                    </div>
                `;
                rankingListEl.insertAdjacentHTML('beforeend', rankHtml);
            });
            
            // 5. 渲染控制項
            // renderPaginationControls(currentClassName, currentPage, totalPages);
            // renderClassNavLinks(currentClassName);

            // 6. 如果當前頁碼不是 URL 中的頁碼，則更新 URL (用於修正無效頁碼)
            if (requestedPage !== currentPage) {
                window.location.hash = `#${encodeURIComponent(currentClassName)}/${currentPage}`;
            }
        }
        
        // ----------------------------------------------------
        // 4. 事件監聽器和初始化
        // ----------------------------------------------------

        // 監聽 URL Hash 變化，以模擬不同班級和頁面
        window.addEventListener('hashchange', renderClassRanking);

        // 頁面載入時初始化
        window.onload = function() {
            // 1. 處理數據
            allClassRankings = processData();
            
            const classKeys = Object.keys(allClassRankings);
            
            if (classKeys.length === 0) {
                 classTitleEl.textContent = '❌ 無效數據';
                 errorMessageEl.classList.remove('hidden');
                 return;
            }

            // 2. 設定初始 Hash 或執行渲染
            const hash = window.location.hash.substring(1);
            const initialClass = decodeURIComponent(hash.split('/')[0]);

            if (!hash || !allClassRankings[initialClass]) {
                // 如果沒有 Hash 或 Hash 無效，設定為第一個班級的第一頁
                window.location.hash = `#${encodeURIComponent(classKeys[0])}/1`;
            } else {
                // 否則，直接執行渲染
                renderClassRanking();
            }
        };

    </script>
</body>
</html>
